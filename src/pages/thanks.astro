---
import HeroLayout from '~/layouts/HeroLayout.astro';
import Brands from '~/components/widgets/Brands.astro';
import Content from '~/components/widgets/Content.astro';
import Image from '~/components/common/Image.astro';
import { createHero, HERO_IMAGES, HERO_OPACITY } from '~/utils/hero';
import { supporters } from '~/data/thanks';

const metadata = {
  title: 'Thanks to our friends and supporters',
};

const hero = createHero({
  image: HERO_IMAGES.nostr,
  alt: 'Thanks to our friends and supporters',
  opacity: HERO_OPACITY.lighter,
  title: 'Thanks to our friends and supporters',
  subtitle: 'Bitcoin District is a community, not a business with a budget. We are grateful for the support of our community volunteers, friends and supporters.',
});

// Sort supporters by rank (ascending) and map to format expected by Brands component
const sortedSupporters = [...supporters].sort((a, b) => a.rank - b.rank);
const brandImages = sortedSupporters.map(supporter => ({
  src: supporter.logo.src,
  alt: supporter.logo.alt,
  href: supporter.href,
}));

---

<HeroLayout metadata={metadata} hero={hero} contentBackground={{ type: 'transparent' }} showScrollIndicator={false} heroMinHeightClass="min-h-[60vh]">

  <div slot="hero-bottom" class="relative z-10 -mt-8 pb-6">
    <Brands
      title="Friends & Supporters"
      subtitle="A few of the companies and friends who have supported the Bitcoin District community"
      images={brandImages}
      classes={{ imageMaxHeight: '!max-h-[100px] sm:!max-h-[120px] md:!max-h-[140px] lg:!max-h-[150px]' }}
    />
  </div>

  {sortedSupporters.map((supporter, index) => 
    supporter.detailedSection && (
      <Content
        title={supporter.detailedSection.title}
        subtitle={supporter.detailedSection.subtitle}
        content={supporter.detailedSection.content}
        callToAction={supporter.detailedSection.callToAction}
        imageAlign="center"
      >
        <Fragment slot="image">
          <a href={supporter.href} target="_blank" rel="noopener noreferrer" class="hidden md:inline-flex">
            <Image
              src={supporter.logo.src}
              alt={supporter.logo.alt}
              width={400}
              height={400}
              class="mx-auto max-w-[200px] md:max-w-[250px] lg:max-w-[300px] object-contain shadow"
              layout="contained"
            />
          </a>
        </Fragment>
      </Content>
    )
  )}
  
</HeroLayout>

